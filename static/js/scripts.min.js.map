{"version":3,"sources":["forms.js","tables.js"],"names":["initJsValidation","$","each","this","attr","messages","errorWrapperSelector","errorWrapperClass","errorClassOnElement","JSON","parse","rules","filter","i","depends","undefined","dependentValSelectors","Array","isArray","key","dependentElement","dependentValSelector","push","elementId","required","val","value","hasOwnProperty","additionalValidators","validate","errorClass","errorElement","errorPlacement","error","element","html","highlight","closest","addClass","unhighlight","removeClass","id","empty","submitHandler","form","hasClass","myAjax","submit","initUploadWidgets","on","nextAll","hide","show","edit_switch","change","widget","first","length","remove_switch","click","updateUploadAddRemove","last","updateUploadWidgets","document","ready","fadeIn","row","columns","find","name","data","input","text","trim","fadeOut","values","fn","submitForm","toInject","type","appendTo","inputPrefix","els","get","dataAttr","multiCheckbox","indexOf","disabled","checked","test","nodeName","isMultiCheckbox","replace","charAt","toLowerCase","slice","inArray","deparam","params","coerce","obj","coerce_types","true","false","null","split","j","v","param","decodeURIComponent","cur","keys","keys_last","shift","concat","isNaN","jQuery","dataTable","columnDefs","orderable","targets","map","item","parseInt"],"mappings":"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","file":"scripts.min.js","sourcesContent":["$(document).ready(function ($) {\r\n\r\n\t$('.btn-update').each(function() {\r\n\t\t$(this).on('click', function() {\r\n\t\t\tvar form = $('#update');\r\n\r\n\t\t\tif(form.length>0) {\r\n\t\t\t\tif(!form.hasClass('active')) {\r\n\t\t\t\t\tform.fadeIn('fast');\r\n\t\t\t\t\tform.addClass('active');\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar row = $(this).closest('tr'),\r\n\t\t\t\t\tcolumns = row.find('td');\r\n\t\t\t\tcolumns.each(function() {\r\n\t\t\t\t\tvar name = $(this).data('name'),\r\n\t\t\t\t\t\tinput = form.find('#' + name);\r\n\t\t\t\t\tif(input.length > 0) {\r\n\t\t\t\t\t\tinput.val($(this).text().trim());\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n\t$('.btn-cancel').each(function() {\r\n\t\t$(this).on('click', function() {\r\n\t\t\tvar form = $(this).closest('form');\r\n\t\t\tform.find(\".form-control\").val(\"\");\r\n\t\t\t$(this).closest('.hidden').fadeOut('fast').removeClass('active');\r\n\t\t});\r\n\t});\r\n\r\n\t//js validation\r\n\tinitJsValidation();\r\n\r\n\t// auto-populate\r\n\t$('form[data-populate]').each(function () {\r\n\t\t$(this).values();\r\n\t});\r\n\r\n});\r\n\r\n//submit form via JS, allows injection or change of values\r\n$.fn.submitForm = function (toInject) {\r\n\tif (typeof toInject === 'object') {\r\n\t\tfor (var key in toInject) {\r\n\t\t\t//change a value if element exits\r\n\t\t\tif ($(\"input[name='\" + key + \"']\", this).length > 0) {\r\n\t\t\t\t$(\"input[name='\" + key + \"']\", this).val(toInject[key]);\r\n\t\t\t} else {//or insert a new one if it doesn't\r\n\t\t\t\tif (toInject.hasOwnProperty(key)) {\r\n\t\t\t\t\t$('<input>').attr({\r\n\t\t\t\t\t\ttype: 'hidden',\r\n\t\t\t\t\t\tid: key,\r\n\t\t\t\t\t\tname: key,\r\n\t\t\t\t\t\tvalue: toInject[key]\r\n\t\t\t\t\t}).appendTo(this);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t$(this).submit();\r\n};\r\n\r\n/* jQuery.values: get or set all of the name/value pairs from child input controls\r\n * @argument data {array} If included, will populate all child controls.\r\n * @argument inputPrefix {string} If included, will prefix all inputs and uppercase the first char\r\n * @returns element if data was provided, or array of values if not\r\n */\r\n$.fn.values = function (data, inputPrefix) {\r\n\tvar els = $(this).find(':input').get();\r\n\r\n\t//if data and inputPrefix are not passed we try to read them from the data-populate and data-populate-prefix attributes\r\n\tif (typeof data != 'undefined') {\r\n\t\tif (typeof data != 'object') {\r\n\t\t\tdata = JSON.parse(data);\r\n\t\t}\r\n\t} else {\r\n\t\tvar dataAttr = $(this).attr('data-populate');\r\n\t\tif (typeof dataAttr != \"undefined\") {\r\n\t\t\tdata = JSON.parse(dataAttr);\r\n\t\t\tif (typeof data != 'object') {\r\n\t\t\t\tdata = JSON.parse(data);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif (typeof inputPrefix == 'undefined') {\r\n\t\tinputPrefix = $(this).attr('data-populate-prefix');\r\n\t}\r\n\r\n\tif (typeof data == 'undefined') {\r\n\t\t// return all data\r\n\t\tdata = {};\r\n\r\n\t\t$.each(els, function () {\r\n\t\t\t//var inputName = (typeof inputPrefix == 'string') ? (inputPrefix + this.name.charAt(0).toUpperCase() + this.name.slice(1)) : this.name;\r\n\t\t\tvar multiCheckbox = (this.type == 'checkbox' && this.name.indexOf(\"[]\") > -1);\r\n\t\t\tif (this.name && !this.disabled && (this.checked || /select|textarea/i.test(this.nodeName) || /text|hidden|password/i.test(this.type))) {\r\n\t\t\t\tif (multiCheckbox) {\r\n\t\t\t\t\tif (data[this.name] === undefined)\r\n\t\t\t\t\t\tdata[this.name] = [];\r\n\t\t\t\t\tdata[this.name].push($(this).val());\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdata[this.name] = $(this).val();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn data;\r\n\t} else {\r\n\t\t$.each(els, function () {\r\n\t\t\tvar key = this.name;\r\n\t\t\tvar isMultiCheckbox = (this.type == 'checkbox' && key.indexOf(\"[]\") > -1);\r\n\t\t\tif (isMultiCheckbox) {\r\n\t\t\t\tkey = key.replace(\"[]\", '');\r\n\t\t\t}\r\n\t\t\tif (typeof inputPrefix == 'string') {\r\n\t\t\t\tkey = key.replace(inputPrefix, '');\r\n\t\t\t\tkey = key.charAt(0).toLowerCase() + key.slice(1);\r\n\t\t\t}\r\n\t\t\tif (this.name && data[key]) {\r\n\t\t\t\tif (isMultiCheckbox) {\r\n\t\t\t\t\t$(this).attr(\"checked\", ($.inArray($(this).val(), data[key]) >= 0));\r\n\t\t\t\t} else if (this.type == 'checkbox' || this.type == 'radio') {\r\n\t\t\t\t\t$(this).attr(\"checked\", (data[key] == $(this).val()));\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$(this).val(data[key]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn $(this);\r\n\t}\r\n};\r\n\r\n/*\r\n jQuery deparam is an extraction of the deparam method from Ben Alman's jQuery BBQ\r\n http://benalman.com/projects/jquery-bbq-plugin/\r\n */\r\n(function ($) {\r\n\t$.deparam = function (params, coerce) {\r\n\t\tvar obj = {},\r\n\t\t\t\tcoerce_types = {'true': !0, 'false': !1, 'null': null};\r\n\r\n\t\t// Iterate over all name=value pairs.\r\n\t\t$.each(params.replace(/\\+/g, ' ').split('&'), function (j, v) {\r\n\t\t\tvar param = v.split('='),\r\n\t\t\t\t\tkey = decodeURIComponent(param[0]),\r\n\t\t\t\t\tval,\r\n\t\t\t\t\tcur = obj,\r\n\t\t\t\t\ti = 0,\r\n\t\t\t\t\t// If key is more complex than 'foo', like 'a[]' or 'a[b][c]', split it\r\n\t\t\t\t\t// into its component parts.\r\n\t\t\t\t\tkeys = key.split(']['),\r\n\t\t\t\t\tkeys_last = keys.length - 1;\r\n\r\n\t\t\t// If the first keys part contains [ and the last ends with ], then []\r\n\t\t\t// are correctly balanced.\r\n\t\t\tif (/\\[/.test(keys[0]) && /\\]$/.test(keys[keys_last])) {\r\n\t\t\t\t// Remove the trailing ] from the last keys part.\r\n\t\t\t\tkeys[keys_last] = keys[keys_last].replace(/\\]$/, '');\r\n\r\n\t\t\t\t// Split first keys part into two parts on the [ and add them back onto\r\n\t\t\t\t// the beginning of the keys array.\r\n\t\t\t\tkeys = keys.shift().split('[').concat(keys);\r\n\r\n\t\t\t\tkeys_last = keys.length - 1;\r\n\t\t\t} else {\r\n\t\t\t\t// Basic 'foo' style key.\r\n\t\t\t\tkeys_last = 0;\r\n\t\t\t}\r\n\r\n\t\t\t// Are we dealing with a name=value pair, or just a name?\r\n\t\t\tif (param.length === 2) {\r\n\t\t\t\tval = decodeURIComponent(param[1]);\r\n\r\n\t\t\t\t// Coerce values.\r\n\t\t\t\tif (coerce) {\r\n\t\t\t\t\tval = val && !isNaN(val) ? +val              // number\r\n\t\t\t\t\t\t\t: val === 'undefined' ? undefined         // undefined\r\n\t\t\t\t\t\t\t: coerce_types[val] !== undefined ? coerce_types[val] // true, false, null\r\n\t\t\t\t\t\t\t: val;                                                // string\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (keys_last) {\r\n\t\t\t\t\t// Complex key, build deep object structure based on a few rules:\r\n\t\t\t\t\t// * The 'cur' pointer starts at the object top-level.\r\n\t\t\t\t\t// * [] = array push (n is set to array length), [n] = array if n is\r\n\t\t\t\t\t//   numeric, otherwise object.\r\n\t\t\t\t\t// * If at the last keys part, set the value.\r\n\t\t\t\t\t// * For each keys part, if the current level is undefined create an\r\n\t\t\t\t\t//   object or array based on the type of the next keys part.\r\n\t\t\t\t\t// * Move the 'cur' pointer to the next level.\r\n\t\t\t\t\t// * Rinse & repeat.\r\n\t\t\t\t\tfor (; i <= keys_last; i++) {\r\n\t\t\t\t\t\tkey = keys[i] === '' ? cur.length : keys[i];\r\n\t\t\t\t\t\tcur = cur[key] = (i < keys_last) ? cur[key] || (keys[i + 1] && isNaN(keys[i + 1]) ? {} : []) : val;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Simple key, even simpler rules, since only scalars and shallow\r\n\t\t\t\t\t// arrays are allowed.\r\n\r\n\t\t\t\t\tif ($.isArray(obj[key])) {\r\n\t\t\t\t\t\t// val is already an array, so push on the next value.\r\n\t\t\t\t\t\tobj[key].push(val);\r\n\r\n\t\t\t\t\t} else if (obj[key] !== undefined) {\r\n\t\t\t\t\t\t// val isn't an array, but since a second value has been specified,\r\n\t\t\t\t\t\t// convert val into an array.\r\n\t\t\t\t\t\tobj[key] = [obj[key], val];\r\n\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// val is a scalar.\r\n\t\t\t\t\t\tobj[key] = val;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if (key) {\r\n\t\t\t\t// No value was defined, so set something meaningful.\r\n\t\t\t\tobj[key] = coerce ? undefined : '';\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn obj;\r\n\t};\r\n})(jQuery);\r\n\r\n//initializes validate.js rules from Zend backend validation rules in data attributes\r\nfunction initJsValidation()\r\n{\r\n\t$('form').each(function () {\r\n\t\tif ($(this).attr('data-validation-initialized'))\r\n\t\t\treturn;\r\n\r\n\t\tif ($(this).attr('data-js-validation')) {\r\n\t\t\tvar messages = {};\r\n\t\t\tvar errorWrapperSelector = $(this).attr('data-error-wrapper-selector');\r\n\t\t\tvar errorWrapperClass = $(this).attr('data-error-wrapper-class');\r\n\t\t\tvar errorClassOnElement = $(this).attr('data-error-class-on-element');\r\n\t\t\t$('input[data-error-messages], textarea[data-error-messages], checkbox[data-error-messages], select[data-error-messages]', this).each(function () {\r\n\t\t\t\tmessages[$(this).attr('name')] = JSON.parse($(this).attr('data-error-messages'));\r\n\t\t\t});\r\n\t\t\t//additional rules\r\n\t\t\tvar rules = {};\r\n\t\t\t$('*', this).filter(':input').each(function () {\r\n\t\t\t\tvar i = 0;\r\n\t\t\t\tif (!$(this).attr('id'))\r\n\t\t\t\t\treturn;\r\n\t\t\t\tvar depends = $(this).attr('depends');\r\n\t\t\t\tif (depends !== undefined)\r\n\t\t\t\t\tdepends = JSON.parse(depends);\r\n\t\t\t\telse\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tvar dependentValSelectors = [];\r\n\t\t\t\tif (!Array.isArray(depends.key))\r\n\t\t\t\t\tdepends.key = [depends.key];\r\n\r\n\t\t\t\tfor (i in depends.key) {\r\n\t\t\t\t\tvar key = depends.key[i];\r\n\t\t\t\t\tvar dependentElement = $('*[name=\"' + key + '\"]');\r\n\t\t\t\t\tvar dependentValSelector = (dependentElement.attr('type') == 'radio') ? 'input[name=\"' + key + '\"]:checked' : '#' + key;\r\n\t\t\t\t\tdependentValSelectors.push(dependentValSelector);\r\n\t\t\t\t}\r\n\t\t\t\tvar elementId = $(this).attr('id');\r\n\t\t\t\trules[elementId] = {\r\n\t\t\t\t\trequired: {\r\n\t\t\t\t\t\tdepends: function () {\r\n\t\t\t\t\t\t\tfor (i in dependentValSelectors) {\r\n\t\t\t\t\t\t\t\tif ($(dependentValSelectors[i]).val() == depends.value)\r\n\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tif (depends.hasOwnProperty('additionalValidators')) {\r\n\t\t\t\t\tfor (i in depends.additionalValidators) {\r\n\t\t\t\t\t\trules[elementId][i] = depends.additionalValidators[i];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t$(this).validate({\r\n\t\t\t\t'errorClass': $(this).attr('data-error-class'),\r\n\t\t\t\t'errorElement': $(this).attr('data-error-element'),\r\n\t\t\t\terrorPlacement: function (error, element) {\r\n\t\t\t\t\t$('.error-placement-wrapper[data-element-id=' + element.attr('id') + ']').html(error);\r\n\t\t\t\t},\r\n\t\t\t\thighlight: function (element) {\r\n\t\t\t\t\tif (errorWrapperSelector && errorWrapperClass) {\r\n\t\t\t\t\t\t$(element).closest(errorWrapperSelector).addClass(errorWrapperClass);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (errorClassOnElement) {\r\n\t\t\t\t\t\t$(element).addClass(errorClassOnElement);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tunhighlight: function (element) {\r\n\t\t\t\t\tif (errorWrapperSelector && errorWrapperClass) {\r\n\t\t\t\t\t\t$(element).closest(errorWrapperSelector).removeClass(errorWrapperClass);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$('.error-placement-wrapper[data-element-id=' + element.id + ']').empty();\r\n\t\t\t\t\tif (errorClassOnElement) {\r\n\t\t\t\t\t\t$(element).removeClass(errorClassOnElement);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t'messages': messages,\r\n\t\t\t\trules: rules,\r\n\t\t\t\tsubmitHandler: function (form) {\r\n\t\t\t\t\t//prevent multiple form submissions\r\n\t\t\t\t\tif (!$(form).attr('data-form-submitted') || $(this).attr('data-allow-multiple-submissions')) {\r\n\t\t\t\t\t\t$(form).attr('data-form-submitted', '1');\r\n\t\t\t\t\t\tif ($(form).hasClass('ajax')) {\r\n\t\t\t\t\t\t\t$(form).myAjax($(form).attr('data-to-inject'));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tform.submit();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t$(this).attr('data-validation-initialized', '1');\r\n\t\t} else {\r\n\t\t\t//prevent multiple form submissions on no-js-validated forms\r\n\t\t\tif (!$(this).hasClass('ajax') && !$(this).attr('data-allow-multiple-submissions')) {\r\n\t\t\t\t$(this).submit(function () {\r\n\t\t\t\t\tif (!$(this).attr('data-form-submitted')) {\r\n\t\t\t\t\t\t$(this).attr('data-form-submitted', '1');\r\n\t\t\t\t\t\tthis.submit();\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n}\r\n\r\n//upload widget init functions\r\n$.fn.updateUploadAddRemove = function () {\r\n\tif (!$('.part-optional:hidden', this).length) {\r\n\t\t$(\".add-upload\", this).hide();\r\n\t} else {\r\n\t\t$(\".add-upload\", this).show();\r\n\t}\r\n\r\n\tif (!$('.part-optional:visible', this).length) {\r\n\t\t$(\".remove-upload\", this).hide();\r\n\t} else {\r\n\t\t$(\".remove-upload\", this).show();\r\n\t}\r\n};\r\n\r\nfunction initUploadWidgets()\r\n{\r\n\t//set up upload widget listeners\r\n\t$('body').on(\"change\", \".upload-widget input[type=hidden][name^='edit_']\", function () {\r\n\t\tif ($(this).val() == 1) {\r\n\t\t\t$(this).nextAll('.part-edit:first').hide();\r\n\t\t\t$(this).nextAll('.part-input:first').show();\r\n\t\t} else {\r\n\t\t\t$(this).nextAll('.part-input:first').hide();\r\n\t\t\t$(this).nextAll('.part-edit:first').show();\r\n\t\t}\r\n\t});\r\n\t$('body').on(\"click\", \".upload-widget .edit-upload\", function () {\r\n\t\tvar edit_switch = $(\"input[type=hidden][name^='edit_']\", $(this).closest(\".upload-part\"));\r\n\t\tedit_switch.val(1);\r\n\t\tedit_switch.change();\r\n\t});\r\n\t$('body').on('click', '.upload-widget .add-upload', function () {\r\n\t\tvar widget = $(this).closest('.upload-widget');\r\n\t\tvar first = $(\".part-optional:hidden:first\", widget);\r\n\t\tif (first.length > 0) {\r\n\t\t\tvar edit_switch = $(\"input[type=hidden][name^='edit_']\", first);\r\n\t\t\tedit_switch.val(1);\r\n\t\t\tedit_switch.change();\r\n\t\t\tvar remove_switch = $(\"input[type=hidden][name^='remove_']\", first);\r\n\t\t\tremove_switch.val(0);\r\n\t\t\tremove_switch.change();\r\n\t\t\tfirst.show();\r\n\t\t\t$('input[type=file]', first).click();\r\n\t\t}\r\n\t\twidget.updateUploadAddRemove();\r\n\t});\r\n\t$('body').on('click', '.upload-widget .remove-upload', function () {\r\n\t\tvar widget = $(this).closest('.upload-widget');\r\n\t\tvar last = $(\".part-optional:visible:last\", widget);\r\n\t\tif (last.length > 0) {\r\n\t\t\tlast.hide();\r\n\t\t\tvar edit_switch = $(\"input[type=hidden][name^='edit_']\", last);\r\n\t\t\tedit_switch.val(0);\r\n\t\t\tedit_switch.change();\r\n\t\t\tvar remove_switch = $(\"input[type=hidden][name^='remove_']\", last);\r\n\t\t\tremove_switch.val(1);\r\n\t\t\tremove_switch.change();\r\n\t\t\t$(\"input[type=file]\", last).val('');\r\n\t\t}\r\n\t\twidget.updateUploadAddRemove();\r\n\t});\r\n\r\n\tupdateUploadWidgets();\r\n}\r\n\r\nfunction updateUploadWidgets()\r\n{\r\n\t//form sections switches init\r\n\t$(\".upload-widget input[type=hidden][name^='edit_']\").each(function () {\r\n\t\t$(this).change();\r\n\t});\r\n\t$(\".upload-widget\").each(function () {\r\n\t\t$(this).updateUploadAddRemove();\r\n\t});\r\n}\r\n","$(document).ready(function() {\r\n    $('.datatable').each(function() {\r\n    \t$(this).dataTable( {\r\n\t\t\"columnDefs\": [\r\n\t\t\t\t{ \"orderable\": false, \"targets\": $(this).data('disabled').split(',').map(function(item) { return parseInt(item, 10); }) }\r\n\t\t\t]\r\n\t\t} );\r\n    });\r\n} );"],"sourceRoot":"/source/"}